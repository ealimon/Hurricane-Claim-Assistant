<!DOCTYPE html><html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Hurricane Claim Assistant</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --navy: #173a63;
      --gold: #c8922b;
      --gold-700: #a6761e;
      --bg: #ffffff;
      --text: #0f172a;
      --muted: #475569;
      --border: #e2e8f0;
      --answer-bg: #f8fafc;
    }
    * { box-sizing: border-box; }
    html, body {
      height: 100%;
      margin: 0;
      background: var(--bg);
      color: var(--text);
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
    }/* Compact, centered widget */
.wrap { max-width: 420px; margin: 0 auto; padding: 14px; }
.widget {
  border: 1px solid var(--border);
  border-radius: 16px;
  background: #fff;
  box-shadow: 0 10px 30px rgba(2,6,23,0.06);
  padding: 16px;
  display: grid;
  gap: 12px;
}

/* Answer area with suggestions */
.answer-box {
  background: var(--answer-bg);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 12px;
  min-height: 160px;
  max-height: 280px;
  overflow: auto;
  font-size: 14px;
  line-height: 1.5;
  white-space: pre-wrap;
}
.answer-box.empty { color: var(--muted); }

/* Suggested questions (gold, same as Ask button) */
.suggestions h3 { margin: 0 0 8px 0; font-size: 13px; color: var(--navy); }
.suggestions ul { list-style: none; margin: 0; padding: 0; display: grid; gap: 8px; }
.suggestions li {
  background: var(--gold);
  color: #1f2937;
  border: 1px solid var(--gold-700);
  border-radius: 10px;
  padding: 10px 12px;
  cursor: pointer;
  font-weight: 600;
  transition: transform .05s ease, box-shadow .15s ease, background .15s ease;
}
.suggestions li:hover { background: var(--gold-700); color: #111827; box-shadow: 0 2px 10px rgba(0,0,0,.08); }
.suggestions li:active { transform: translateY(1px); }

/* Input row */
form { display: grid; gap: 8px; }
.input-row { display: grid; grid-template-columns: 1fr auto; gap: 8px; align-items: stretch; }
textarea {
  resize: vertical;
  min-height: 46px;
  max-height: 120px;
  padding: 10px 12px;
  border: 1px solid var(--border);
  border-radius: 10px;
  font-size: 14px;
  line-height: 1.35;
  outline: none;
  transition: box-shadow .15s ease, border-color .15s ease;
}
textarea:focus { border-color: #cbdcfb; box-shadow: 0 0 0 3px rgba(23,58,99,0.15); }
button {
  background: var(--gold);
  color: #1f2937;
  border: 0;
  border-radius: 10px;
  padding: 0 16px;
  font-size: 14px;
  font-weight: 700;
  cursor: pointer;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  min-width: 110px;
  transition: background .15s ease, transform .05s ease;
}
button:hover { background: var(--gold-700); }
button:active { transform: translateY(1px); }
button:disabled { opacity: .65; cursor: not-allowed; background: #e8c27a; }

.spinner {
  width: 14px; height: 14px;
  border: 2px solid rgba(0,0,0,0.2);
  border-top-color: rgba(0,0,0,0.7);
  border-radius: 50%;
  animation: spin 1s linear infinite;
  margin-right: 8px;
  display: none;
}
@keyframes spin { to { transform: rotate(360deg); } }

/* Visually hidden (fix for previous snippet) */
.sr-only {
  position: absolute;
  width: 1px; height: 1px;
  padding: 0; margin: -1px;
  overflow: hidden; clip: rect(0,0,0,0);
  white-space: nowrap; border: 0;
}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="widget" role="application" aria-label="Hurricane Claim Assistant">
      <div id="answer" class="answer-box empty" aria-live="polite"></div>  <form id="ask-form">
    <label class="sr-only" for="question">Your question</label>
    <div class="input-row">
      <textarea id="question" name="question" placeholder="Type your question…" required></textarea>
      <button id="submit-btn" type="submit" aria-label="Submit question">
        <span id="btn-spinner" class="spinner"></span>
        <span id="btn-text">Ask</span>
      </button>
    </div>
  </form>
</div>
  </div>  <script>
    // CONFIG
    const DEMO_MODE = true; // set to false after you deploy the backend
    const BACKEND_URL = "https://your-worker-subdomain.workers.dev/api/assistant-answer"; // replace after deploying worker
    const IRRELEVANT_MESSAGE = "I’m sorry. That isn’t a relevant question.";

    // Suggested questions
    const SUGGESTED_QUESTIONS = [
      "Do you charge any upfront fees?",
      "How does the free consultation work?",
      "Do you help if my claim was denied or underpaid?",
      "What areas do you serve in Tampa Bay?",
      "What kind of results have you achieved?"
    ];

    // Relevance guard
    const RELEVANCE_KEYWORDS = [
      "hurricane","storm","wind","roof","leak","damage","water","flood","property","property damage",
      "insurance","claim","claims","denied","underpaid","low offer","adjuster","attorney","law","law firm",
      "consultation","free consultation","no fees","zero upfront","contingency",
      "tampa","pinellas","hillsborough","pasco","tampa bay","florida",
      "karkatselos","your property advocate","results","successes",
      "office","address","location","contact","call","phone","813","map"
    ];
    function isRelevant(q) {
      const qs = (q || "").toLowerCase();
      return RELEVANCE_KEYWORDS.some(kw => qs.includes(kw));
    }

    function setLoading(loading) {
      const btn = document.getElementById("submit-btn");
      const sp = document.getElementById("btn-spinner");
      const bt = document.getElementById("btn-text");
      btn.disabled = loading;
      sp.style.display = loading ? "inline-block" : "none";
      bt.textContent = loading ? "Thinking…" : "Ask";
    }

    function showAnswer(text, opts = {}) {
      const box = document.getElementById("answer");
      box.classList.toggle("empty", !text);
      if (!text) {
        renderSuggestions();
      } else {
        box.textContent = text;
        box.style.borderColor = "var(--border)";
        box.style.background = "var(--answer-bg)";
        if (opts.type === "error") {
          box.style.borderColor = "#fde2e2";
          box.style.background = "#fff7f7";
        }
      }
    }

    async function askBackend(question) {
      const res = await fetch(BACKEND_URL, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ question })
      });
      if (!res.ok) {
        const t = await res.text().catch(() => "");
        throw new Error("Backend error: " + (t || res.status));
      }
      const data = await res.json();
      return data.answer || "";
    }

    // Demo answers
    function demoAnswer(question) {
      const q = question.toLowerCase();
      if (q.includes("fee") || q.includes("fees") || q.includes("upfront") || q.includes("contingency") || q.includes("cost") || q.includes("price")) {
        return "Consultation is free. The firm typically operates on a contingency basis—no attorney fees unless there’s a recovery.";
      }
      if (q.includes("consultation")) {
        return "Schedule your free consultation from this page or by calling 813-445-5780. We’ll review your situation and outline next steps.";
      }
      if (q.includes("denied") || q.includes("underpaid") || q.includes("low offer")) {
        return "Yes—if your hurricane damage claim was denied or underpaid, the firm can evaluate the decision and push for a fair result.";
      }
      if (q.includes("area") || q.includes("serve") || q.includes("tampa") || q.includes("pinellas") || q.includes("hillsborough") || q.includes("pasco")) {
        return "The page focuses on the Tampa Bay Area, including Hillsborough, Pinellas, and Pasco counties.";
      }
      if (q.includes("result") || q.includes("success")) {
        return "Recent success themes include full roof replacements secured and payment for interior water damages after reversing insurer denials.";
      }
      if (q.includes("address") || q.includes("office") || q.includes("location")) {
        return "Office: 5331 Primrose Lake Circle, Suite 212, Tampa, FL 33647.";
      }
      if (q.includes("call") || q.includes("phone") || q.includes("contact")) {
        return "Call 813-445-5780 or use the page form to schedule your free consultation.";
      }
      return "This page covers hurricane-claim help, free consultations, the Tampa Bay service area, and examples of results. Ask about any of these topics.";
    }

    function renderSuggestions() {
      const box = document.getElementById("answer");
      box.classList.add("empty");
      box.innerHTML = `
        <div class="suggestions">
          <h3>Suggested questions</h3>
          <ul>
            ${SUGGESTED_QUESTIONS.map(q => `<li data-q="${q.replace(/"/g, '&quot;')}">${q}</li>`).join("")}
          </ul>
        </div>
      `;
      box.querySelectorAll("li").forEach(li => {
        li.addEventListener("click", () => {
          const q = li.getAttribute("data-q");
          const input = document.getElementById("question");
          input.value = q;
          document.getElementById("ask-form").requestSubmit();
        });
      });
    }

    document.getElementById("ask-form").addEventListener("submit", async (e) => {
      e.preventDefault();
      const input = document.getElementById("question");
      const question = input.value.trim();
      if (!question) return;

      if (!isRelevant(question)) {
        showAnswer(IRRELEVANT_MESSAGE);
        return;
      }

      setLoading(true);
      try {
        const answer = DEMO_MODE
          ? (await new Promise(r => setTimeout(r, 400)), demoAnswer(question))
          : await askBackend(question);
        showAnswer(answer);
      } catch (err) {
        console.error(err);
        showAnswer("Sorry—something went wrong. Please try again.", { type: "error" });
      } finally {
        setLoading(false);
        input.focus();
        input.select();
      }
    });

    // Initial render
    renderSuggestions();
  </script></body>
</html>
